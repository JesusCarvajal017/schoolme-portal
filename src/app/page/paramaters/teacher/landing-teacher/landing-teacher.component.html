<header tuiHeader class="m-1">
  <h1 tuiTitle>
    <div class="col-12 d-flex">
      <span>Profesores</span>
      <p class="count">{{ teacher.length }} Profesores</p>
    </div>
  </h1>
  <aside tuiAccessories>
    <div tuiAppearance="secondary" tuiButtonGroup>
      
      <!-- creacion de docente -->
      <button class="btn-add" (click)="modalCommand(1)">
        <mat-icon>add_circle</mat-icon>
        Crear Profesor
      </button>
    </div>
  </aside>
</header>

<section class="table-container">
  <!-- Tabs -->
  <div class="col-12 row ">
    <div class="col-6">
      <div class="tabs">
        <button [ngClass]="{'active' : idicadorActive}" (click)="cambiarStatus(1)">Activos</button>
        <button [ngClass]="{'active' : idicadorActive == 0}" (click)="cambiarStatus(0)">Inactivos</button>
      </div>
    </div>
    <div class="col-6 d-flex justify-content-end">
      <!-- Buscador -->
      <div class="actions">
        <div class="search-box m-1">
          <mat-icon>search</mat-icon>
          <input #searchInput type="text" placeholder="Buscar..." (input)="onSearch(searchInput.value)" />
        </div>
      </div>
    </div>
  </div>

<app-listado-generico [elements]="teacher">
  <ng-container contenido>
    <section class="table-container">


      <!-- Tabla -->
      <table class="custom-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Nombres</th>
            <th>Apellidos</th>
            <th>Tipo</th>
            <th>Identificación</th>
            <th>Teléfono</th>
            <th>Status</th>
            <th class="text-center">Acción</th>
          </tr>
        </thead>
        <tbody>
          @for (item of paginatedUsers; track item.id) {
          <tr>
            <td>{{ ($index + 1) + (currentPage - 1) * pageSize }}</td>
            <td>{{ item.fullName}}</td>
            <td>{{ item.lastName}}</td>
            <td>{{ item.acronymDocument }}</td>
            <td>{{ item.identification }}</td>
            <td>{{ item.phone }}</td>
            <td>
              <mat-slide-toggle [checked]="item.status === 1" (change)="logical($event, item.id)"></mat-slide-toggle>
            </td>
            <td class="actions-col">
              <button mat-icon-button (click)="modalCommand(2, item.id)">
                <mat-icon>edit</mat-icon>
              </button>

              <button mat-icon-button [swal]="{
              title: 'Confirmacion',
              text: '¿Deseas borrar este registro?',
              showCancelButton: true
          }" (confirm)="deleteRegister(item.id)">
                <mat-icon>delete</mat-icon>
              </button>

              <button mat-icon-button>
                <mat-icon>more_vert</mat-icon>
              </button>
            </td>
          </tr>
          }
        </tbody>
      </table>

      <!-- Paginación -->
      <div class="pagination" *ngIf="totalPages > 1">
        <button (click)="changePage(currentPage - 1)" [disabled]="currentPage === 1">
          &lt;
        </button>

        <button *ngFor="let page of [].constructor(totalPages); let i = index" (click)="changePage(i + 1)"
          [class.active]="currentPage === i + 1">
          {{ i + 1 }}
        </button>

        <button (click)="changePage(currentPage + 1)" [disabled]="currentPage === totalPages">
          &gt;
        </button>
      </div>
    </section>
  </ng-container>
</app-listado-generico>

<!-- Modal simplificado -->
<ng-template let-observer [tuiDialogOptions]="{label: titleTeacher, size: 'l'}" [(tuiDialog)]="open">
  <div class="modal-content">

    <!-- Modo Creación: Formulario de profesor -->
    <ng-container *ngIf="!isEditMode">
      <!-- <app-form-teacher [title]="titleTeacher" [actionDescriptio]="'Crear'" (posteoForm)="handleTeacherSubmit($event)"></app-form-teacher> -->
      <app-form-todos [isUser]="isUser" [modalInfo]="modalInfo" [model]="modelUpdate" (posteoForm)="handleEpsSubmit($event)"></app-form-todos>

    </ng-container>

    <!-- Modo Edición: Solo formulario de información personal -->
    <ng-container *ngIf="isEditMode">
      <ng-container *ngIf="modelPerson; else loadingPerson">
        <app-form-todos [isUser]="isUser" [modalInfo]="modalInfo" [model]="modelPerson"
          (posteoForm)="handlePersonSubmit($event)">
        </app-form-todos>
      </ng-container>

      <ng-template #loadingPerson>
        <div class="loading-state text-center p-5">
          <p class="text-muted">Cargando información personal...</p>
        </div>
      </ng-template>
    </ng-container>

  </div>
</ng-template>