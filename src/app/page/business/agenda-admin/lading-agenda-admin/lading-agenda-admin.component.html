<header tuiHeader class="m-1">
  <h1 tuiTitle>
    <div class="col-12 d-flex">
      <span>Agenda</span>
    </div>
  </h1>
  <aside tuiAccessories>
    <div tuiAppearance="secondary" tuiButtonGroup>

      <!-- creacion de docente -->
      <button class="btn-add" (click)="modalCommand(1)">
        <mat-icon>add_circle</mat-icon>
          Crear agenda
      </button>
    </div>
  </aside>
</header>

<section class="table-container">
  <!-- Tabs -->
  <div class="col-12 row ">
    <div class="col-6">
      <div class="tabs">
        <button [ngClass]="{'active' : idicadorActive}" (click)="cambiarStatus(1)">Activos</button>
        <button [ngClass]="{'active' : idicadorActive == 0}" (click)="cambiarStatus(0)">Inactivos</button>
      </div>
    </div>
    <div class="col-6 d-flex justify-content-end">
      <!-- Buscador -->
      <div class="actions">
        <div class="search-box m-1">
          <mat-icon>search</mat-icon>
          <input #searchInput type="text" placeholder="Buscar..." (input)="onSearch(searchInput.value)" />
        </div>
      </div>
    </div>
  </div>

<app-listado-generico [elements]="agenda">
  <ng-container contenido>
    <section class="table-container">

      <!-- =============================== Tabla =============================== -->
      <table class="custom-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Nombre</th>
            <th>Descripción</th>
            <th>Status</th>
            <th class="text-center">Acción</th>
          </tr>
        </thead>
        <tbody>
          @for (item of paginatedUsers; track item.id) {
            <tr>
              <td>{{ ($index + 1) + (currentPage - 1) * pageSize }}</td>
              <td>{{ item.name}}</td>
              <td>{{ item.description}}</td>
              <td>
                <mat-slide-toggle [checked]="item.status === 1" (change)="logical($event, item.id)"></mat-slide-toggle>
              </td>
              <td class="actions-col">


                <button mat-icon-button (click)="modalCommand(2, item.id)">
                  <mat-icon>edit</mat-icon>
                </button>
                
                <button mat-icon-button [swal]="{
                  title: 'Confirmacion',
                  text: '¿Deseas borrar este registro?',
                  showCancelButton: true
                }" (confirm)="deleteRegister(item.id)">
                  <mat-icon>delete</mat-icon>
                </button>

                <button mat-icon-button [matMenuTriggerFor]="menu">
                  <mat-icon>more_vert</mat-icon>
                </button>

                <!-- menu de agenda = configuracion, asignación -->
                <mat-menu #menu="matMenu">
                  <button mat-menu-item xPosition="before" (click)="asignacionAgenda(item.id)">
                    <mat-icon>checklist</mat-icon>
                    Asignación
                  </button>

                  <button mat-menu-item xPosition="before" (click)="confgAgenda(item.id)">
                    <mat-icon>settings</mat-icon>
                    Configuracion agenda
                  </button>
              
                </mat-menu>
              </td>
            </tr>
          }
        </tbody>
      </table>

      <!-- Paginación -->
      <div class="pagination" *ngIf="totalPages > 1">
        <button (click)="changePage(currentPage - 1)" [disabled]="currentPage === 1">
          &lt;
        </button>

        <button *ngFor="let page of [].constructor(totalPages); let i = index" (click)="changePage(i + 1)"
          [class.active]="currentPage === i + 1">
          {{ i + 1 }}
        </button>

        <button (click)="changePage(currentPage + 1)" [disabled]="currentPage === totalPages">
          &gt;
        </button>
      </div>
    </section>
  </ng-container>
</app-listado-generico>

<ng-template let-observer [tuiDialogOptions]="{label: titleTeacher, size: 'm'}" [(tuiDialog)]="open" >
  <div class="modal-content">
      <app-form-agenda-admin [modalInfo]="modalInfo" [model]="modelUpdate" (posteoForm)="handleSubmit($event)"></app-form-agenda-admin>
  </div>
</ng-template>